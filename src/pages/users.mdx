import { CompactTable, CompactRow, CompactCell } from '@/components/Table'

export const description =
  'On this page, weâ€™ll dive into the different user endpoints you can use to manage users programmatically in an e-commerce platform.'

# Users

As the name suggests, users are a core part of our e-commerce platform. The reason for the platform's existence is to facilitate secure transactions and interactions with users. On this page, we'll explore the different user endpoints you can use to manage users programmatically. We'll cover how to query, create, update, and delete users, as well as handle edge cases like unauthorized access and invalid inputs. {{ className: 'lead' }}

## User model

The user model contains all the information about your users, such as their name, email, phone number, and role. It also includes the user's verification status, device details, and other essential data for secure transactions on the platform.

### Properties

<CompactTable>
  <CompactRow>
    <CompactCell code>_id</CompactCell>
    <CompactCell type>objectId</CompactCell>
    <CompactCell>Unique identifier for the user.</CompactCell>
  </CompactRow>
  <CompactRow>
    <CompactCell code>name</CompactCell>
    <CompactCell type>string</CompactCell>
    <CompactCell>The full name of the user. This field is required.</CompactCell>
  </CompactRow>
  <CompactRow>
    <CompactCell code>email</CompactCell>
    <CompactCell type>string</CompactCell>
    <CompactCell>A unique email address for the user. It should be verified. This field is required.</CompactCell>
  </CompactRow>
  <CompactRow>
    <CompactCell code>phoneNumber</CompactCell>
    <CompactCell type>string</CompactCell>
    <CompactCell>A unique phone number for the user.</CompactCell>
  </CompactRow>
  <CompactRow>
    <CompactCell code>password</CompactCell>
    <CompactCell type>string</CompactCell>
    <CompactCell>User's password. This field is required.</CompactCell>
  </CompactRow>
  <CompactRow>
    <CompactCell code>verified</CompactCell>
    <CompactCell type>boolean</CompactCell>
    <CompactCell>Indicates whether the user's email is verified. Default is false.</CompactCell>
  </CompactRow>
  <CompactRow>
    <CompactCell code>role</CompactCell>
    <CompactCell type>string</CompactCell>
    <CompactCell>The role of the user. It can either be "user" or "admin". Default is "user".</CompactCell>
  </CompactRow>
  <CompactRow>
    <CompactCell code>fcmToken</CompactCell>
    <CompactCell type>string</CompactCell>
    <CompactCell>Firebase Cloud Messaging token for the user's device, used for push notifications.</CompactCell>
  </CompactRow>
  <CompactRow>
    <CompactCell code>deviceIds</CompactCell>
    <CompactCell type>array</CompactCell>
    <CompactCell>An array of device IDs associated with the user.</CompactCell>
  </CompactRow>
</CompactTable>

---

## List all users {{ tag: 'GET', label: '/v1/users' }}

<Row>
  <Col>

    This endpoint allows you to retrieve a paginated list of all your users. Only admins are authorized to access this endpoint.

    ### Edge Cases:
    - **Unauthorized**: If the request is made by a non-admin user, the server will respond with a `403 Forbidden` status code.
    - **No Users Found**: If no users exist, the server will respond with a `404 Not Found` status code, or return an empty list.

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="GET" label="/v1/users">

    ```bash {{ title: 'cURL' }}
    curl -G {{host}}/api/v1/users \
      -H "Authorization: Bearer {admin_token}"
    ```


    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "data": [
        {
          "_id": "WAz8eIbvDR60rouK",
          "name": "John Doe",
          "email": "john.doe@example.com",
          "phoneNumber": "+123456789",
          "verified": true,
          "role": "admin",
          "deviceIds": ["device123", "device456"]
        },
        {
          "_id": "hSIhXBhNe8X1d8Et"
          // ...
        }
      ]
    }
    ```

  </Col>
</Row>

---

## Invite a user {{ tag: 'POST', label: '/v1/users' }}

<Row>
  <Col>

    This endpoint allows you to add a new user to your user list in the e-commerce platform. To add a user, you must provide their name, email, and password. Phone number is optional but must be unique if provided.

    ### Required attributes

    <Properties>
      <Property name="name" type="string">
        The full name of the user.
      </Property>
      <Property name="email" type="string">
        The unique email address of the user.
      </Property>
      <Property name="password" type="string">
        User's password.
      </Property>
    </Properties>

    ### Edge Cases:
    - **Email Already Taken**: If the provided email is already in use, the server will respond with a `409 Conflict` status code.
    - **Missing Required Fields**: If any required fields are missing, a `400 Bad Request` status code will be returned.

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="POST" label="/v1/users">

    ```bash {{ title: 'cURL' }}
    curl {{host}}/api/v1/users \
      -H "Authorization: Bearer {admin_token}" \
      -d name="John Doe" \
      -d email="john.doe@example.com" \
      -d password="securepassword123"
    ```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "_id": "WAz8eIbvDR60rouK",
      "name": "John Doe",
      "email": "john.doe@example.com",
      "role": "user",
      "verified": false
    }
    ```

  </Col>
</Row>

---

## Retrieve a user {{ tag: 'GET', label: '/v1/users/:id' }}

<Row>
  <Col>

    This endpoint allows you to retrieve a user by providing their ID. Only admins can access this endpoint. Refer to [the user model](#the-user-model) at the top of this page for details about user properties.

    ### Edge Cases:
    - **Unauthorized**: If a non-admin user tries to access this endpoint, the server will return a `403 Forbidden` status code.
    - **User Not Found**: If no user with the provided ID exists, the server will return a `404 Not Found` status code.

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="GET" label="/v1/users/WAz8eIbvDR60rouK">

    ```bash {{ title: 'cURL' }}
    curl {{host}}/api/v1/users/WAz8eIbvDR60rouK \
      -H "Authorization: Bearer {admin_token}"
    ```

    ```js
    import ApiClient from '@example/ecommerce-api'

    const client = new ApiClient(adminToken)

    await client.users.get('WAz8eIbvDR60rouK')
    ```

    ```python
    from ecommerce_api import ApiClient

    client = ApiClient(adminToken)

    client.users.get("WAz8eIbvDR60rouK")
    ```

    ```php
    $client = new \Ecommerce\ApiClient($adminToken);

    $client->users->get('WAz8eIbvDR60rouK');
    ```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "_id": "WAz8eIbvDR60rouK",
      "name": "John Doe",
      "email": "john.doe@example.com",
      "phoneNumber": "+123456789",
      "verified": true,
      "role": "user",
      "deviceIds": ["device123"],
      "fcmToken": "fcm_token_example"
    }
    ```

  </Col>
</Row>
